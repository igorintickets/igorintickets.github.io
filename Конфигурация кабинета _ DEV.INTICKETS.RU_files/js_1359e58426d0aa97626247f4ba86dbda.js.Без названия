new Vue({el:"#offline",template:"\n<form id=\"offline-commissions-form\" v-if=\"agents.length\" class=\"mtop-30\" @submit.prevent=\"save()\">\n  <h1>\u041E\u0444\u0444\u043B\u0430\u0439\u043D \u0430\u0433\u0435\u043D\u0442\u044B</h1>\n  <div class=\"mtop-15 mbottom-15\">\n    <table class=\"dataTable display compact cell-border width-auto min-600\">\n      <thead>\n        <tr>\n          <th>\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435</th>\n          <th>\u042E\u0440. \u043B\u0438\u0446\u043E</th>\n          <th>\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F</th>\n          <th v-if=\"type !== 'seance'\">\u0421\u041E\u0425\u0420\u0410\u041D\u0418\u0422\u042C \u0438 \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u043D\u0443\u044E<br>\u043A\u043E\u043C\u0438\u0441\u0441\u0438\u044E \u0432 \u043D\u0435\u043D\u0430\u0447\u0430\u0432\u0448\u0438\u0435\u0441\u044F \u0441\u0435\u0430\u043D\u0441\u044B</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"(agent, index) in sortedList\" :key=\"agent.id\" :class=\"{odd: index%2===0, even: index%2===1}\">\n          <td>{{agent.name}}</td>\n          <td>{{agent.company_title}}</td>\n          <td>\n            <input type=\"text\" class=\"form-text full-width\" size=\"5\" maxlength=\"5\"\n                   pattern=\"[0-9]{1,2}[.,]?[0-9]{0,2}\" required v-model.trim=\"commissions[agent.id]\">\n          </td>\n          <td v-if=\"type !== 'seance'\">\n            <a href=\"javascript:\" @click=\"save(agent.id)\">\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432 \u0441\u0435\u0430\u043D\u0441\u044B</a>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <input id=\"offline-commissions-submit\" type=\"submit\" class=\"form-submit\" value=\"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C\">\n</form>\n  ",data:function data(){return Drupal.settings.offline},computed:{sortedList:function sortedList(){return _.sortBy(this.agents,"name")}},methods:{save:function save(agentId){var _this=this;if(agentId){var isFormValid=$("#offline-commissions-form")[0].reportValidity();if(!isFormValid)return void $("#offline-commissions-submit").trigger("click")}this.lock||(this.lock=!0,this.$http.post("/ajax/commission/save",{id:this.id,type:this.type,commissions:this.commissions}).then(function(responce){if("success"===responce.body.status)return void swal("","\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u0438 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B","success");throw"Error"}).then(function(){agentId&&_this.$http.post("/ajax/commission/copy",{event:"event"===_this.type?_this.id:0,agent:agentId}).then(function(responce){if("success"===responce.body.status)return void swal("","\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u0438 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u044B","success");throw"Error"}).catch(function(){swal("","\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043C\u0438\u0441\u0441\u0438\u0438","error")})}).catch(function(){swal("","\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043A\u043E\u043C\u0438\u0441\u0441\u0438\u0438","error")}).finally(function(){_this.lock=!1}))}}});;
